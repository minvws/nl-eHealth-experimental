<!DOCTYPE html>
<html lang="EN">
<head>
  <title>FHIR2QR</title>
  <style>
    body
    {
      background-color: thistle;
    }
  </style>
</head>
<body>
  <div>
    <h1>FHIR 2 QR</h1>
    <div>
     <form action="/fhir2qr" method="post">
      <label for="fhir_server">FHIR Server:</label>
      Use: <input type="text" id="fhir_server" name="fhir_server" value="https://server.fire.ly/r4/" readonly><br>

      This queries the given FHIR server for Immunization resources, and will:
      <ol>
        <li>convert the returned JSON to an eHN Vaccination Minimum Data Set as per Annex 1
          <input type="submit" value="show" formaction="fhir2json"/>,
          </li>
        <li>semantically compress it,
        <li>serialize it,
          <input type="submit" value="show" formaction="fhir2jsoncbor"/>,
	</li>
        <li>digitally sign it <input type="submit" value="show" formaction="fhir2jsoncborcosezlib"/> with:
	<ul>
		<li> private key as a <a href="dsc-worker.key">PEM file</a> (<i>which you normally would not get!</i>).  </li>
		<li> and the KeyID of the DSCS certificate <a href="dsc-worker.pem">PEM file</a> (plain concatenation; not a LDIFF).  </li>
		<li> Which is on this Country DSCS list, available as <a href="masterlist-dsc.pem">PEM file</a>.  </li>
		<li> And which is signed by the Country CSCA, availablea <a href="csca.pem">PEM file</a>.  </li>
	</ul>
        </li>
        <li>LZMA compress it,
          <input type="submit" value="show" formaction="fhir2jsoncborcosezlib"/>,
	</li>
        <li><a href="https://tools.ietf.org/html/draft-faltstrom-base45-02">Base45</a> encode it
          <input type="submit" value="show" formaction="fhir2jsoncborcosezlibb45"/>,
	</li>
        <li> and finally generate QR code from it
         <input type="submit" value="show qr" formaction="fhir2jsoncborcosezlibb45qr"/>.
	</li>
      </ol>
      <p>Or 
         <input type="submit" value="show the sizes" formaction="fhir2size"/> after each step.
    </form>
  </div>
</body>
</html>
